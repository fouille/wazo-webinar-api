import"@fortawesome/fontawesome-free/js/fontawesome";import"@fortawesome/fontawesome-free/js/solid";import"@fortawesome/fontawesome-free/js/regular";import"@fortawesome/fontawesome-free/js/brands";import Swal from"sweetalert2";import{access_domain,wazo_auth,get_user}from"./main";const token=sessionStorage.getItem("token"),mon_tenant=sessionStorage.getItem("tenant_uuid"),utilisateur_uuid=sessionStorage.getItem("pbx_user_uuid"),data_retention={nom:[],prenom:[],renvoi_busy:[],renvoi_busy_dest:[]};$(".logout").on("click",(function(e){e.preventDefault,fetch(access_domain+wazo_auth+"/"+token,{method:"DELETE",headers:{accept:"application/json","X-Auth-Token":token}}).then((function(e){if(!e.ok)throw new Error("HTTP error, status = "+e.status)})).then((function(e){sessionStorage.clear(),document.location.href="../"})).catch((function(e){console.log(e)}))})),(async()=>{const e={method:"GET",headers:{accept:"application/json","Wazo-Tenant":mon_tenant,"X-Auth-Token":token}},n=await fetch(access_domain+get_user+utilisateur_uuid,e).then((e=>e.json()));if(console.log(n),console.log(n.email),console.log("Busy Enable ? "+n.forwards.busy.enabled),console.log("Busy destination: "+n.forwards.busy.destination),console.log("Noanswer Enable ? "+n.forwards.noanswer.enabled),console.log("Noanswer destination: "+n.forwards.noanswer.destination),console.log("Unconditional Enable ? "+n.forwards.unconditional.enabled),console.log("Unconditional destination: "+n.forwards.unconditional.destination),document.getElementById("pbx_user_uuid").innerText=n.firstname,document.getElementById("pbx_user_").innerText=n.firstname,1==n.forwards.busy.enabled)document.getElementById("busy").innerText="Activé",document.getElementById("busy_number").innerText=n.forwards.busy.destination;else{document.getElementById("busy").innerText="Désactivé";const e=document.getElementById("busy_number");null==n.forwards.busy.destination?e.innerText="aucun numéro saisi":e.innerText=n.forwards.busy.destination}data_retention.nom=n.firstname,data_retention.prenom=n.firstname,data_retention.renvoi_busy=n.forwards.busy.enabled,data_retention.renvoi_busy_dest=n.forwards.busy.destination,localStorage.setItem("DataRetention",JSON.stringify(data_retention)),document.getElementById("noanswer").innerText=n.forwards.noanswer.enabled,document.getElementById("unconditional").innerText=n.forwards.unconditional.enabled})();